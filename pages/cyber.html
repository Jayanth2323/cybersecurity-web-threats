import streamlit as st
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Set page config for better UX
st.set_page_config(page_title="Correlation Matrix", layout="wide")

st.title("ðŸ“Š Correlation Matrix: Feature Relationships")
st.markdown(
    """
    Explore the linear relationships between numerical features
    using a correlation heatmap.
    This visualization can help surface patterns,
    multicollinearity, and trends in your data.
    """
)

@st.cache_data
def load_data():
    return pd.read_csv("data/analyzed_output.csv")

df = load_data()

# Filter numeric columns
numeric_cols = df.select_dtypes(include=["float64", "int64"]).columns

if len(numeric_cols) >= 2:
    st.subheader("Correlation Heatmap")
    st.markdown(f"**Numeric Features Analyzed:** `{', '.join(numeric_cols)}`")

    # Generate heatmap
    fig, ax = plt.subplots(figsize=(12, 8))
    corr = df[numeric_cols].corr()

    heatmap = sns.heatmap(
        corr,
        annot=True,
        cmap="vlag",
        center=0,
        fmt=".2f",
        linewidths=0.5,
        linecolor="white",
        square=True,
        cbar_kws={"shrink": 0.75},
    )
    plt.xticks(rotation=45, ha="right")
    plt.yticks(rotation=0)
    plt.tight_layout()
    st.pyplot(fig)
else:
    st.warning(
        """There are not enough numeric columns in the dataset for
        correlation analysis."""
    )